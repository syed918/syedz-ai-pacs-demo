<!DOCTYPE html>
<html>
<head>
<title>SYEDZ AI-PACS</title>

<style>
body{font-family:Arial;background:#e6ebf0;margin:0}
.header{background:#2f6fd6;color:white;padding:12px;font-size:22px}
.toolbar{background:#d5dbe2;padding:8px}
table{width:100%;border-collapse:collapse;background:white;margin:10px}
th{background:#2f6fd6;color:white;padding:6px}
td{padding:6px;border:1px solid #ddd;text-align:center}
.ai-btn{background:#28a745;color:white;border:none;padding:6px 12px}
#result{margin:10px;padding:12px;background:#e7f2ff;border-left:5px solid #2f6fd6}
</style>
</head>

<body>

<div class="header">SYEDZ AI-PACS</div>

<div class="toolbar">
<input type="file" id="xrayUpload">
<button onclick="sendToAI()">Analyze X-ray</button>
</div>

<table>
<tr>
<th>Patient</th>
<th>Modality</th>
<th>Study</th>
<th>AI</th>
</tr>
<tr>
<td>PT-001</td>
<td>XRAY</td>
<td>Chest PA</td>
<td><button class="ai-btn" onclick="sendToAI()">Generate AI</button></td>
</tr>
</table>

<div id="result">Upload X-ray to analyze.</div>

<script>
async function sendToAI(){

 const file = document.getElementById("xrayUpload").files[0];
 const resultBox = document.getElementById("result");

 if(!file){
   alert("Upload X-ray first");
   return;
 }

 const formData = new FormData();
 formData.append("image", file);

 resultBox.innerHTML="Analyzing AI model...";

 try{

   const response = await fetch(
    "https://syedasrar-syedz-ai-backend.hf.space/api/predict/",
     { method:"POST", body:formData }
   );

   if(!response.ok) throw new Error();

   const data = await response.json();

   let output="<b>AI Pathology Probabilities:</b><br><br>";

   for(let k in data){
     let v=parseFloat(data[k]);
     if(isNaN(v)) continue;
     output+=`${k}: ${(v*100).toFixed(1)}%<br>`;
   }

   if(!output.includes("%")){
     output="AI returned no valid result.";
   }

   resultBox.innerHTML=output;

 }catch{
   resultBox.innerHTML="AI backend error. Try again.";
 }
}
</script>
<script>
async function sendToAI(){

 const file = document.getElementById("xrayUpload").files[0];
 const resultBox = document.getElementById("result");

 if(!file){
   alert("Upload X-ray first");
   return;
 }

 const reader = new FileReader();

 reader.onload = async function(){

   resultBox.innerHTML="Analyzing...";

   try{

     const response = await fetch(
       "https://syedasrar-syedz-ai-backend.hf.space/api/predict/",
       {
         method:"POST",
         headers:{"Content-Type":"application/json"},
         body: JSON.stringify({
           data:[reader.result]
         })
       }
     );

     const result = await response.json();
     const data = result.data[0];

     let output="<b>AI Pathology Probabilities:</b><br><br>";

     for(let k in data){
       output += `${k}: ${(data[k]*100).toFixed(1)}%<br>`;
     }

     resultBox.innerHTML=output;

   }catch{
     resultBox.innerHTML="AI backend error";
   }
 };

 reader.readAsDataURL(file);
}
</script>
