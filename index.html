<!DOCTYPE html>
<html>
<head>
<title>SYEDZ AI-PACS</title>

<style>
body{
  font-family:Arial;
  background:#eef3f9;
  margin:0;
}

.header{
  background:#2f66c9;
  color:white;
  padding:15px;
  font-size:22px;
}

.toolbar{
  background:#dbe5f4;
  padding:10px;
}

button{
  padding:6px 12px;
  margin-left:5px;
  cursor:pointer;
}

table{
  width:100%;
  border-collapse:collapse;
  background:white;
  margin-top:10px;
}

th{
  background:#2f66c9;
  color:white;
  padding:8px;
}

td{
  padding:8px;
  border:1px solid #ddd;
  text-align:center;
}

.ai-btn{
  background:#2ea44f;
  color:white;
  border:none;
}

#result{
  margin:15px;
  padding:15px;
  background:#f4f8ff;
  border-left:5px solid #2f66c9;
  min-height:60px;
}
</style>
</head>

<body>

<div class="header">SYEDZ AI-PACS</div>

<div class="toolbar">
  <input type="file" id="xrayUpload">
  <button onclick="sendToAI()">Analyze X-ray</button>
</div>

<table>
<tr>
  <th>Patient</th>
  <th>Modality</th>
  <th>Study</th>
  <th>AI</th>
</tr>
<tr>
  <td>PT-001</td>
  <td>XRAY</td>
  <td>Chest PA</td>
  <td><button class="ai-btn" onclick="sendToAI()">Generate AI</button></td>
</tr>
</table>

<div id="result">
AI Pathology Probabilities will appear here.
</div>

<script>

async function sendToAI(){

 const fileInput = document.getElementById("xrayUpload");
 const resultBox = document.getElementById("result");

 if(fileInput.files.length === 0){
   alert("Please upload X-ray first.");
   return;
 }

 const file = fileInput.files[0];

 const reader = new FileReader();

 reader.onload = async function(){

   resultBox.innerHTML = "Analyzing AI model...";

   try{

     const response = await fetch(
       "https://syedasrar-syedz-ai-backend.hf.space/run/predict",
       {
         method: "POST",
         headers: {
           "Content-Type": "application/json"
         },
         body: JSON.stringify({
           data: [reader.result]
         })
       }
     );

     if(!response.ok){
       throw new Error("Server error");
     }

     const json = await response.json();

     if(!json.data || !json.data[0]){
       throw new Error("Invalid response");
     }

     const data = json.data[0];

     let output = "<b>AI Pathology Probabilities:</b><br><br>";

     let valid = false;

     for(const key in data){

       let value = parseFloat(data[key]);

       if(!isNaN(value)){
         valid = true;
         output += key + ": " + (value*100).toFixed(1) + "%<br>";
       }

     }

     if(!valid){
       output = "AI returned no valid result.";
     }

     resultBox.innerHTML = output;

   }catch(error){

     resultBox.innerHTML = "AI backend error. Check if backend Space is running.";

   }

 };

 reader.readAsDataURL(file);

}

</script>

</body>
</html>
